.get_data <-
function(fit, data = NULL, complain = FALSE) {
  if(is.null(data)){
    if (complain)
      warning ("The `data` argument is not provided. Data will be extracted from model fit.")
    data <- eval(fit$call$data)
  }
  data
}
.onAttach <-
function(libname, pkgname) {
  # to show a startup message
  #  packageStartupMessage("xmsPANDA v1.1.671 successfully loaded.")
  
  suppressMessages(library(RColorBrewer))
  #suppressMessages(library(data.table))
  suppressMessages(library(plyr))
  suppressMessages(library(parallel))
  suppressMessages(library(CMA))
  suppressMessages(library(ggplot2))
  suppressMessages(library(gplots))
  #suppressMessages(library(extrafont))
  
}
.onLoad <-
function(libname, pkgname) {
  # something to run
  packageStartupMessage("xmsPANDA v1.1.74 successfully loaded.")
  suppressMessages(library(RColorBrewer))
  #suppressMessages(library(data.table))
  suppressMessages(library(plyr))
  suppressMessages(library(parallel))
  suppressMessages(library(CMA))
  suppressMessages(library(ggplot2))
  suppressMessages(library(gplots))
  # suppressMessages(library(extrafont))
}
.Random.seed <-
c(10403L, 624L, 470169481L, -111841866L, 1840322751L, -305036300L, 
-1737617819L, -1253988382L, 586934779L, -1198056192L, -1703200511L, 
798143182L, 1046193399L, 1002087628L, -207596707L, -1896121734L, 
-1089256013L, 1118562136L, 96450937L, 275491558L, 1221298223L, 
689270948L, 1837598549L, 515616786L, -733026197L, -311915344L, 
-124937999L, -753355266L, 33923687L, -1977006212L, 53185101L, 
1244702890L, -1976454621L, -503681784L, 437958505L, -98683882L, 
116052895L, 1248430420L, 2077244485L, -183188414L, 333087451L, 
-2122651552L, -711396127L, -993229522L, 2142763991L, -1711958484L, 
1484094781L, 1252942554L, 193215123L, 711941816L, 28717401L, 
-792721082L, -209323249L, -887566844L, -1286132427L, 927982706L, 
1040562507L, -1370935280L, 2015120593L, -345956258L, -1949716153L, 
-540372772L, 258812973L, 299346186L, -430842109L, 1994767464L, 
-1661917367L, 325331574L, -942408065L, -953270604L, 401300005L, 
1966084258L, 1492618171L, 1544446912L, -698965823L, -1438021746L, 
-1605254473L, 1259550604L, 1338087197L, 1238334266L, 530685811L, 
687375896L, -202729159L, -706898010L, 449568239L, -1384850588L, 
-1323580651L, -13088558L, -2070480341L, -775584912L, -2042171215L, 
297319102L, 1294413863L, -168129988L, 1021427213L, -176629398L, 
-1908769821L, 1493351368L, 646022953L, -255897386L, -786130593L, 
-277371884L, 2050451461L, 380341506L, 1787495579L, 1697222432L, 
-1381221215L, 245479918L, -1478428265L, -714372884L, -436428547L, 
-1602829414L, 1252226131L, -2044764808L, 1549070617L, 828134918L, 
-1923796785L, -1316906812L, 1380796661L, 495770930L, -1371886837L, 
716539600L, -234519407L, -1699248866L, -1143595257L, 1762735004L, 
906051565L, -1892927030L, 522422467L, 1177119528L, -1262233847L, 
-1983404234L, 529835071L, 2057156980L, -332634651L, -962643614L, 
1556934011L, -1515951488L, 1754384513L, -328393650L, -98721673L, 
1800833612L, -476144931L, -289653766L, -138299085L, -172235560L, 
921516281L, 1087652966L, -170265681L, -459864540L, -1100759339L, 
1164288402L, 1562954731L, 2012297776L, -2041575311L, -1493860482L, 
-1450279449L, -2123985668L, 1631826381L, 84527658L, 1380255139L, 
1748093576L, -1045424407L, 571813270L, -1948508385L, 1274576596L, 
-213756987L, 2116228546L, -537573797L, 307688928L, 268387425L, 
172207790L, 1455404887L, -349422676L, -853572419L, 1622664282L, 
-1372295661L, -1750721480L, -72650535L, -1378000186L, -619567473L, 
-2146622588L, 1490494645L, 903517682L, -812032821L, 1683004816L, 
169770065L, 587901406L, 1141394631L, 861050460L, -517925971L, 
153717386L, -53022077L, 1425267176L, 1128154825L, 1228923894L, 
-894236161L, 1927279668L, 1357984165L, 1112482338L, 1077677883L, 
-1944506048L, -1460883391L, -88248050L, -645972425L, -549151476L, 
-487104867L, -1367229254L, 288592627L, -139066472L, -1635280711L, 
1846522150L, -1615476369L, -381947676L, -1054901611L, -1174160814L, 
-540779093L, -2035568400L, 1080614961L, -946928578L, 352029607L, 
523063228L, -1810799219L, -643597590L, 269569891L, 239573320L, 
-1419352407L, -622867882L, 1825662175L, 715921812L, 45154181L, 
607870594L, 1708738587L, -540861280L, 877792289L, 477258606L, 
-99338985L, 2113384044L, 564013181L, 473023770L, -537450541L, 
230923000L, -1887850343L, -1023201402L, -2105746353L, -1317310908L, 
-759906187L, -1460072782L, 65130123L, 1641706576L, -400083951L, 
421170846L, 35666567L, -1857111780L, 344762221L, 1083153226L, 
-1725162429L, 33884328L, -400525687L, -24321866L, -554750017L, 
-625676556L, 1106885989L, 1090505442L, -721096453L, -970147840L, 
-1356376063L, -1711634994L, -1942578185L, -1449300020L, 1099686493L, 
2044722554L, -172544845L, 1034347096L, -1166428039L, 978312678L, 
-1642111185L, -1776051292L, -1525746091L, -439184622L, 1311354731L, 
1689577392L, -1135511567L, 1749371134L, 1294883175L, -2112957828L, 
-1190471347L, -1811551318L, -1050715869L, 168044552L, 1667528297L, 
668935958L, 1774480031L, 374502484L, -2075956411L, -1045141694L, 
-1376319013L, -466746528L, 308581345L, 1777195054L, -1080134953L, 
-259137236L, -1221030851L, 597976538L, 1235984787L, 1463278008L, 
-2021674919L, -1383220154L, -380284401L, -2138277628L, -1952048075L, 
1604863858L, 1825833035L, -367850736L, 1944038353L, -777571490L, 
-1814173625L, -1782211620L, -1811678419L, -1239520246L, -840759805L, 
1813837672L, 53110345L, 376348022L, 839456127L, -1663260236L, 
2063993125L, -613338206L, -1394109765L, -895549760L, 1392623553L, 
1323588238L, 537115063L, -1927216500L, -1290000867L, 26672698L, 
-284391821L, -1773240040L, -628910023L, 1112853158L, 920040687L, 
-2045901212L, 368194069L, 294792146L, -1441218261L, 952950384L, 
-1043738703L, 1037585854L, -806951129L, 483071292L, 1945111821L, 
351345770L, 535765731L, -634947896L, 694830633L, -707574826L, 
947204191L, 1504415508L, 330929925L, -816959486L, 705596315L, 
-162026976L, 1643568033L, -680129298L, -1793167209L, 1705956332L, 
565096445L, -2016426342L, 353491795L, -1564288904L, 326987801L, 
1782384902L, 895190991L, -402635836L, 258684917L, 44580914L, 
-332402165L, -2084937264L, 1426580369L, 1634768926L, 1459705351L, 
326581916L, -481882387L, -1433010998L, 884715459L, 1912317480L, 
-1273227767L, -1113253322L, 1505803071L, 1679238260L, 2010518757L, 
-362587038L, 430175355L, -802159232L, 742123393L, 1580920654L, 
1655084919L, 210720076L, -1419236899L, -1234780422L, 116629555L, 
-1871913000L, 241514489L, -488736922L, 1872480943L, 331034916L, 
2139696597L, 1174570130L, -1252945173L, -374106832L, -661526671L, 
-1123544450L, -622512921L, 572659708L, 679542989L, -47903446L, 
-1518293853L, -1116633720L, -46672407L, 1903960214L, 1319351839L, 
-8951340L, 215188165L, -2050443070L, 199216475L, -1392504608L, 
-1698110623L, 164299182L, 676605527L, -1072003412L, -1262447683L, 
427026266L, 736744723L, -551250120L, 590540761L, -1244588602L, 
1280277903L, -1567175036L, -1446767691L, -88540942L, 599106507L, 
1972402320L, -211821743L, -1657357090L, 1766491079L, -1658609316L, 
1175839405L, 515263882L, 662051203L, -1302260504L, -625637943L, 
-521120010L, -1412030209L, -1692115148L, 1948901541L, 110511394L, 
754587195L, -845165504L, -1835675839L, -859945970L, -505465545L, 
1789421580L, 1580199325L, -921747526L, 120355315L, 2059533976L, 
635344825L, 950854694L, 237936751L, 1508580324L, 227797397L, 
1273208146L, -241949525L, 506006512L, 1214889777L, 445945662L, 
1810449063L, -2066490692L, -92425075L, -1386103318L, -1949043101L, 
-1297984440L, -1634916951L, 1201257814L, -502268961L, -764017516L, 
-1957613947L, -572259966L, 1160433435L, 1592211360L, -191190239L, 
1705817710L, -419451881L, -1567557268L, -2077345923L, 1766901786L, 
938708691L, -1155721736L, 1717579673L, 218751622L, -739167409L, 
722475332L, 1718660981L, 1889169842L, 1965364619L, -967487664L, 
1990693649L, 431595934L, -1468436089L, -2054503396L, -1070565779L, 
-750821814L, -1076739261L, -1945287768L, 381072777L, 756044726L, 
1040795327L, 1824807412L, 1807838309L, -2000032286L, -1196820485L, 
2041467648L, -1647347967L, 1596872910L, -345140489L, -1439941940L, 
-1087147683L, 709918842L, 2037846963L, 1678630232L, -1330661511L, 
545263846L, -1739639249L, 861783716L, -1412274859L, -1409976814L, 
-1600096661L, 1022182064L, 420566769L, 1262345214L, 1085476967L, 
-140485252L, -844748723L, 1181167274L, -861339613L, 2021253896L, 
-1926613655L, 1693194774L, -394657377L, 1567055700L, 1794284101L, 
-1872754110L, -2018537253L, 583868000L, 1730949857L, 266021678L, 
-18814505L, 1876044844L, 1672977213L, -937006886L, -1561393005L, 
-1519627080L, 1287991129L, -1398313146L, 838904079L, -1137957884L, 
288426805L, 1292675698L, 37635915L, 1019799056L, -962655535L, 
733562462L, -1303503033L, -546527524L, 358009389L, 1223765770L, 
-678417149L, 499135080L, -941644471L, 247795830L, -434492289L, 
-1011411788L, 442284069L, -1984014686L, 1316198843L, 1260100032L, 
631824065L, -1706349170L, -1928220489L, -1915040372L, -2110606051L, 
-1964342982L, -1483510413L, 454065176L, -23554247L, 924319142L, 
1404931055L, 986919268L, 100966677L, -1359474990L, -1003059157L, 
1824536944L, 306753201L, 63168702L, -687694297L, -314073028L, 
1169841165L, -1460314262L, 566217187L, -1917308472L, 147785001L, 
-1775028522L, 396478303L, -351569388L, 1199031813L, 368890626L, 
1160647323L, -814627552L, -1438811487L, -317300754L, 1572333463L, 
1251876588L, -417546499L, 1186253210L, -1768144301L, -858631304L
)
