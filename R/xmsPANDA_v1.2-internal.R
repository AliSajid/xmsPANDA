.get_data <-
function(fit, data = NULL, complain = FALSE) {
  if(is.null(data)){
    if (complain)
      warning ("The `data` argument is not provided. Data will be extracted from model fit.")
    data <- eval(fit$call$data)
  }
  data
}
.onAttach <-
function(libname, pkgname) {
  # to show a startup message
  #packageStartupMessage("xmsPANDA v1.2 successfully loaded.")
  
  suppressMessages(library(RColorBrewer))
  #suppressMessages(library(data.table))
  suppressMessages(library(plyr))
  suppressMessages(library(parallel))
  suppressMessages(library(CMA))
  suppressMessages(library(ggplot2))
  #suppressMessages(library(extrafont))
  
}
.onLoad <-
function(libname, pkgname) {
  # something to run
  packageStartupMessage("xmsPANDA v1.2 successfully loaded.")
  suppressMessages(library(RColorBrewer))
  #suppressMessages(library(data.table))
  suppressMessages(library(plyr))
  suppressMessages(library(parallel))
  suppressMessages(library(CMA))
  suppressMessages(library(ggplot2))
  # suppressMessages(library(extrafont))
}
.Random.seed <-
c(10403L, 624L, -1625958139L, 1502153218L, -1304355429L, 708875296L, 
-1319354975L, -207649042L, -1215880553L, -158376468L, 377434621L, 
-1419648870L, 375565651L, -1658518920L, -1170533863L, 860996358L, 
40270287L, -1710355004L, 565705205L, 1375312434L, -337181685L, 
-1489122352L, -609892975L, 341348894L, 1551271943L, -1747302244L, 
-132640531L, -183593270L, -1860107837L, -431468504L, 1679964169L, 
608719926L, 241708351L, 16215668L, -986491163L, -596953502L, 
704611963L, 569241472L, 808601985L, 1870752078L, 1179142519L, 
1024778060L, -665211939L, 2036717818L, 999125555L, 1363413464L, 
-1848387079L, 1655714150L, 721403055L, 672004900L, -1005129771L, 
543219346L, -1217288981L, 1347157808L, 671140209L, -598930306L, 
1607689959L, -546692612L, 1840448205L, -229988566L, 2003762851L, 
1165176712L, -1506871319L, 1847351958L, -136042465L, 1071428564L, 
212976837L, -165834046L, 686055259L, -1223492896L, -1949285023L, 
-827425874L, -642850729L, 314904748L, 441652669L, 1650458970L, 
-1471371501L, 1357955384L, -875392551L, 2061488070L, -1836290161L, 
-340879228L, 823317941L, 379867890L, -859916853L, 1505616528L, 
1679801681L, -2024229154L, -1708018233L, -1244615844L, -601299795L, 
1158211466L, -1553110141L, -661143832L, -451041335L, -1576169226L, 
103781119L, -242308812L, 1460216485L, 1270357794L, 455583803L, 
1787278912L, -382848703L, 1136573966L, -1384978633L, -1577586164L, 
1021538205L, -1100457542L, 534268915L, -939317096L, 2083469753L, 
293117478L, -1144745361L, -364386844L, 673426325L, -1612974254L, 
637941419L, -93620752L, 1929027889L, 1846776126L, -1253477209L, 
1533404348L, 1106359949L, -882812950L, 643057763L, 1099824712L, 
-1293531223L, 1001650006L, -368939553L, -245018988L, -1045335931L, 
-1907172478L, 151085339L, -1457249888L, 1766067489L, -850775954L, 
1498177047L, -1056603284L, 1552071037L, 1905713690L, -2123865901L, 
1314078712L, 853660057L, 135437446L, 90187087L, 1429332804L, 
-1530826379L, 857721778L, 1501570955L, 1428994384L, 864646417L, 
-1256875106L, -1227709561L, -1132343780L, 1501919341L, -278136758L, 
760976707L, -1909592664L, 494983049L, 44535222L, 806664383L, 
1186505716L, -1507676571L, 2063976418L, -1767273989L, -876593920L, 
688511233L, 904450766L, -789363465L, -230308660L, 1370026845L, 
-335308166L, -936057421L, -407304360L, -69052039L, -1941583130L, 
-1441322961L, -1983606620L, -563861675L, 1401409554L, -1721464725L, 
2027531440L, -2134624015L, 1291245054L, 8733287L, 1903978364L, 
-1722013107L, -1488926550L, 29053475L, 944737544L, -1360701591L, 
176182294L, 1092514719L, 618703188L, -1714103227L, -622271422L, 
72884955L, 389285984L, 1098355937L, 338863406L, 1679793111L, 
1678816812L, -1328669379L, 700875482L, 192273043L, 67927736L, 
1596510553L, 397027654L, -1063150833L, 290975236L, 1216597301L, 
-1876163470L, -1276421813L, 1615482896L, 832761041L, -229687202L, 
1343836487L, -1095913252L, 871222317L, 1962395914L, 145456899L, 
634051688L, 1829488457L, -1294579082L, 1641520767L, -348823884L, 
1849686565L, -2095828830L, 776285115L, -1135115328L, -947568447L, 
-893409394L, -1098292553L, -255961204L, -899008739L, -1292395718L, 
2120433523L, 2133173784L, 1621965113L, 1876408230L, 1001881071L, 
-1589380252L, -1835506923L, -2077988654L, 323787307L, -229203088L, 
421367985L, 766958270L, -1085878233L, -1804752324L, 397565453L, 
1722349930L, -1016849437L, -1468539960L, -638834903L, -1488883498L, 
-1292355233L, 621724692L, 819726341L, 1419750658L, -1935104869L, 
-670912736L, -869606239L, -2010654226L, -404186729L, 514238700L, 
-1426767619L, -1683037286L, 1882526803L, -1596162696L, -2140696295L, 
-1503234554L, -367996721L, 450934980L, -1474696971L, -695665358L, 
-1111471349L, 30844624L, 103556241L, 1405461790L, -1010450681L, 
-1894493284L, -282992659L, 376199626L, -820172605L, 2116979496L, 
-209815799L, -547764426L, 825771071L, -1983587980L, 723584485L, 
1017338210L, 867863931L, 1930267264L, 1549822081L, 1191394382L, 
1140146295L, 539077196L, 451361501L, -2080089094L, 1277385011L, 
487130328L, -1169172231L, 418276454L, 1986368431L, -1954142684L, 
-1333764395L, 980533650L, 1434348523L, 1302485552L, -1010390927L, 
-2062311554L, 793648615L, -151409412L, 548688333L, -1436947926L, 
-452024925L, -792270200L, 867874537L, -1632154218L, -1253064929L, 
-55599404L, -494472251L, 876033474L, -743250341L, -2108680736L, 
-2128747423L, -840315218L, -1838721193L, -746103892L, -1632099139L, 
-1743780774L, -1721364973L, 327367736L, -2040655655L, 1896317638L, 
1735247503L, 747389828L, 256099509L, 1861662194L, 415169739L, 
-2137932400L, 417668177L, -1372010018L, 798485703L, -1066027428L, 
-824069203L, -729175414L, -630156669L, 907606504L, -1869027639L, 
1962017782L, -201938433L, -1926818764L, 411423141L, 1081295394L, 
-1194741957L, -425569984L, 1062948929L, -1351380722L, -285811145L, 
-1020281588L, 1994391197L, -1880499014L, -80399629L, 270738328L, 
-662030151L, -1538666202L, 534866287L, 1665863908L, 1675369109L, 
1060100690L, -507904597L, 830263536L, -931168207L, -2016598978L, 
1314597799L, -1948225604L, -668858995L, -753689878L, -1602556061L, 
-1342391992L, 2081490601L, 1034021462L, 2112160991L, 1988311444L, 
-896163963L, 1919909506L, -885594085L, 1826372768L, -1743737823L, 
1245217646L, -782510825L, 628280940L, -1613313923L, -1347820262L, 
818464723L, 180402936L, 550260889L, -196259962L, -562529201L, 
-1055224252L, -1983815563L, -2110443854L, 648507019L, -482634672L, 
-1852976111L, -1771524450L, 1901058695L, -1517168356L, -689092755L, 
1880079178L, 1147518019L, -1404426072L, -467986807L, 543097014L, 
-1076703297L, 538709748L, 841899365L, -414979358L, -1892511493L, 
-841623552L, -2009729023L, -925850162L, 223230967L, -592932916L, 
-770407843L, -949478022L, 358141107L, 1731461720L, 1260148857L, 
-290849306L, -1108672721L, 55753636L, -1737779627L, 454996754L, 
-104902805L, 77989808L, 789059569L, 715352318L, -634521241L, 
98693756L, 565934413L, 26610602L, -278333149L, 81348616L, 850335337L, 
-1866381546L, 41421471L, 491361364L, -993522875L, -938965182L, 
620014043L, -1368972448L, 147010529L, 567539758L, -762965289L, 
1999175980L, -2112803779L, 859604442L, -1608695405L, -178980424L, 
-1083027367L, 1828183110L, -1259277809L, 323721476L, -481117131L, 
-117151886L, 154771531L, -258725104L, 1474710481L, 1628787550L, 
648906823L, 1361624028L, -888890579L, 1774095370L, -423844349L, 
-8251544L, 1304757833L, 1314962806L, 1787606399L, 761514420L, 
869968165L, 1238717346L, 1219834555L, -1620566336L, 246439873L, 
400194190L, -1397007945L, 793518732L, -532363747L, -616620486L, 
-464640397L, -251944680L, 1640380473L, -1798378842L, -1774037777L, 
106767972L, -101789163L, 385764306L, -1622253269L, -304218512L, 
-1088393295L, 576089534L, 1350993703L, -675400388L, -1589596915L, 
379665514L, -1952922909L, 1310496456L, -1756043735L, 1691706326L, 
-121057185L, 1002614548L, 1826502405L, -1379774462L, 1387015067L, 
498125344L, -1963623519L, 964439278L, -2086268777L, -345377812L, 
-651735043L, 864544410L, 287538003L, 33552504L, -1844441063L, 
-674813690L, 278341583L, 501179332L, -1481123851L, 2082758706L, 
-1573547509L, 794526160L, 330204049L, 587118622L, -1385105913L, 
-1778753892L, 786935533L, 39197898L, 1530220483L, 243320360L, 
-313084407L, 733428278L, -1981523137L, 1606304884L, -1723157275L, 
1088912482L, 923899003L, -1843845760L, 1787463553L, -514781362L, 
-1694615689L, 1037727052L, 355518941L, 1009704698L, 1909801011L, 
1010434008L, 742905849L, -210200730L, -1364759889L, -953528028L, 
-198849067L, 999203986L, -1809370389L, -739986128L, 8947569L, 
-475647362L, -282798873L, 875902972L, -1166958387L, -1292554966L, 
-288731997L, -897145464L, -1446873623L, 1184776342L, -694725089L, 
-592541228L, 513286853L, 1549588674L, -2044891813L, 1366896864L, 
-1771601055L, 904995246L, -1837380009L, 1693820588L, -119983171L, 
-2125723814L, 1838904595L, 528594744L, -2006609959L, -243583546L, 
-685040241L, -1684672892L, 582005685L, 1951734002L, -1822735413L, 
-430860144L, 749108049L, -1327178530L, 593109959L, 113688924L, 
1180074669L, 982936970L, -74466941L, 2013672680L, -1567611447L, 
-1524467978L, 1939456255L, 569081652L, -1640071003L, 1698325794L, 
1812444731L, -1666651072L, -209424575L, 703882254L, 1708578103L, 
1259571212L, -1533506147L, 452419514L, -2018633229L, -1750131048L, 
2053191609L, 661062694L, -858111889L, 1618623460L)
