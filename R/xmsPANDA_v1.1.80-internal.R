.get_data <-
function(fit, data = NULL, complain = FALSE) {
  if(is.null(data)){
    if (complain)
      warning ("The `data` argument is not provided. Data will be extracted from model fit.")
    data <- eval(fit$call$data)
  }
  data
}
.onAttach <-
function(libname, pkgname) {
  # to show a startup message
  #packageStartupMessage("xmsPANDA v1.1.8 successfully loaded.")
  
  suppressMessages(library(RColorBrewer))
  #suppressMessages(library(data.table))
  suppressMessages(library(plyr))
  suppressMessages(library(parallel))
  suppressMessages(library(CMA))
  suppressMessages(library(ggplot2))
  #suppressMessages(library(extrafont))
  
}
.onLoad <-
function(libname, pkgname) {
  # something to run
  packageStartupMessage("xmsPANDA v1.1.8 successfully loaded.")
  suppressMessages(library(RColorBrewer))
  #suppressMessages(library(data.table))
  suppressMessages(library(plyr))
  suppressMessages(library(parallel))
  suppressMessages(library(CMA))
  suppressMessages(library(ggplot2))
  # suppressMessages(library(extrafont))
}
.Random.seed <-
c(10403L, 624L, 1610954883L, 1620043752L, -1981055799L, -474865162L, 
-2091601921L, 666886708L, 1968752549L, 1105215522L, 1677137211L, 
-1372913856L, -1499158975L, 1955294990L, -681991113L, -1537848564L, 
1173730461L, 881498810L, -1215080205L, -713715304L, 2032291513L, 
221343526L, -2107576465L, 1127702244L, 34377877L, -671328174L, 
501277611L, 1011941104L, 1757304369L, -520322498L, 2131718567L, 
-104170052L, -851100787L, 537123050L, -1375562397L, 252356424L, 
1028562089L, -1299117994L, 1676020447L, -1197275244L, 696489349L, 
-2105836414L, 1052200475L, -707007840L, 1453654561L, -983604882L, 
1187093271L, 419454060L, 1718058621L, -1060527334L, 1104801235L, 
-1167447816L, -737188199L, -14422650L, 274399823L, -1169302460L, 
13424245L, -513758030L, 266425483L, 2101789264L, -1411929583L, 
963054750L, 1070014599L, 1336076060L, -229933715L, 1497299274L, 
-1553964477L, 460265128L, -1295799159L, -1023598922L, 502715839L, 
1564663028L, -256421019L, 1701767394L, -997853445L, 600606208L, 
-1818931711L, 294028238L, 1630994935L, -1508041268L, -1650444195L, 
-1803101318L, -1533218125L, -1129025448L, -1232441735L, -1561355290L, 
1085310255L, 1229785508L, -1512960939L, -2144784110L, -376687253L, 
1500001712L, 417132017L, 250660606L, -135774361L, -1885732740L, 
-791367859L, -1232844374L, 693542691L, 529872392L, 339913833L, 
1217291542L, -1170272097L, 1761043028L, 7078213L, -741178046L, 
-711258149L, -53161632L, 376277473L, 261674542L, 376559831L, 
-1710977236L, 538436157L, -874888230L, -1760270445L, 1814849464L, 
1217095257L, -1842578874L, -904300529L, -1718819068L, 76821045L, 
1668146546L, 421103179L, -343058160L, 650518993L, 1043444062L, 
86691399L, 503826908L, 995676461L, -638858742L, 1159547907L, 
559220072L, 130260041L, -1025713290L, 494320511L, 1528338356L, 
-904290523L, -1027714654L, -298936133L, -1311978304L, -1809467967L, 
1110333582L, -1305862217L, -284249972L, -565806051L, 249289786L, 
-327660429L, -995487976L, 772427321L, -1301116762L, 1062066927L, 
-2140834716L, 1821067285L, 1179044306L, -1463728341L, 982396016L, 
1217086897L, 1874971582L, 558288167L, 189023036L, -1068506355L, 
-242386326L, 401369315L, -1836677944L, -1354859479L, -41909802L, 
139843167L, -553747180L, -80204539L, 860507650L, 645435803L, 
2139912224L, -1112157791L, -136377618L, -602417513L, 1267958252L, 
-2069625347L, -1851546470L, -1811898029L, 772105848L, -2030098919L, 
895076102L, 252030415L, -13717052L, 1764707829L, -271851982L, 
1052473355L, 960671696L, -316384879L, 406394398L, 1643396103L, 
329739420L, -1439570707L, -1216259382L, -553912893L, 1359066152L, 
-1465168887L, 269572150L, 395600191L, -872344972L, 2101324517L, 
848198242L, 850459259L, -1897147520L, 1075174785L, 1262677326L, 
-1745683081L, 32179020L, 2074640349L, 340368634L, -1729796557L, 
2081844696L, -278794759L, -1736821402L, -2080837457L, 1128308516L, 
-1040694315L, 857023122L, 490739947L, -964500688L, 2139708785L, 
2016383102L, 954931943L, -1618393604L, -8988979L, 1910467370L, 
-209456477L, -1499556984L, 235015145L, 1579638422L, -1008051169L, 
628643796L, 1973950661L, -643639614L, 1661981531L, -188555552L, 
-1002579615L, 586284974L, 1165202519L, 275592364L, -406066755L, 
-488258214L, 576625427L, -290118344L, 2133501401L, -1519660090L, 
-991976561L, -1510785916L, 2052991413L, -281372942L, 579283403L, 
-1389967728L, 1722962257L, -1673708834L, 1944283591L, -1019097252L, 
-2104051539L, -222319734L, -893624445L, 1228219112L, 1966783433L, 
-1755671306L, 1645201151L, 448548148L, 1172928165L, 1302291234L, 
-1546838981L, -1310090688L, -282737343L, 830751246L, -1605264585L, 
561124876L, -1450818659L, -711975494L, 1940144115L, 834243736L, 
-900641351L, 1908843046L, -730741137L, -1398896156L, -774307947L, 
257178450L, -926373205L, -1543087632L, 93795633L, 1559893310L, 
1016408231L, 1059653820L, -1307997555L, -1741022230L, -170050461L, 
1520263752L, -263365719L, -1220347050L, 582787551L, 119861908L, 
-1954823035L, -1080287358L, 2099303707L, -1288174176L, 1640341793L, 
-175000466L, -1069215209L, -1957582996L, 1565494653L, 1348511258L, 
-336702253L, 1559995384L, -523377255L, 1596104838L, -1855497905L, 
144344900L, 1138804085L, -1971712078L, 641506187L, 1308204368L, 
-1154479855L, 1593712542L, 414734215L, 2140598812L, -934851475L, 
1281801290L, 572426563L, 1756320168L, 221375369L, 91787702L, 
313060543L, 1913276404L, 534184549L, 1823542242L, 323157499L, 
-779738880L, -1189778175L, -1179494706L, 419821815L, 1348724940L, 
1537197917L, 1131372154L, 108321203L, -195859624L, 1318612345L, 
454545126L, -1233626065L, -1757465436L, -2014479531L, 1673794578L, 
-316998549L, 970494128L, -495661839L, 316758526L, -368773529L, 
-1662809220L, -1144521139L, -2057466710L, 414729763L, 1833103624L, 
-706712727L, 361977878L, 445425567L, 247745876L, 410202181L, 
-1644812222L, 644585179L, -777261984L, -1911740191L, -1803671250L, 
2051821527L, 520149548L, -1192300227L, 718554842L, 1517276819L, 
-409410888L, 464053593L, -1623315130L, -631451889L, 1642369540L, 
-1854463691L, -1437972366L, 1805372747L, -495242224L, -765624111L, 
-1254374306L, -298646201L, 1533465820L, 1057202221L, 1161202954L, 
-1092455677L, -835698584L, -800007351L, -953463178L, -14691713L, 
-1129643340L, -959951323L, -1467779934L, 315793339L, 1686202304L, 
1973736641L, 1754082190L, 265295543L, 1367374732L, 1169492765L, 
245849914L, -1692978317L, -1834743272L, -872985287L, 825080742L, 
1875685871L, -1646092444L, -1879722219L, 2032446674L, -1946743253L, 
-1363572880L, -572382031L, 1319460542L, -1090878425L, 729337404L, 
-1066257907L, 436845930L, 366284771L, 1565474760L, -25478359L, 
1171813590L, 1629121887L, -2028574700L, -1202824187L, -311365374L, 
-793765733L, 652120864L, 13922465L, -461939218L, 1632193943L, 
-298136340L, -1905650435L, -2097109094L, -1750923181L, -1119035016L, 
1601938713L, 1652455942L, -981465905L, -1399759676L, -287228683L, 
-143965902L, -731594997L, -244610352L, 1408940177L, -1279907554L, 
1377006343L, 695302044L, 1787540461L, 502209994L, 986193091L, 
1484255016L, -564688119L, 154323766L, -1120634817L, -1520534156L, 
-1233298971L, -640246430L, -197394053L, -1583649152L, -1131152255L, 
-2099986354L, 1383068791L, -1484272052L, -611971363L, -1476911110L, 
994790707L, -1687459624L, 1378741497L, 281569382L, 103729071L, 
457755172L, 1437709013L, 1479935378L, 1729945579L, -378978768L, 
2141142129L, -2063195266L, -113913369L, 497602812L, 600319437L, 
-151081430L, 1727240611L, 1770147464L, 1776143081L, -724414058L, 
1814426399L, 2061189844L, -959625275L, -422807102L, -1381082533L, 
1234172384L, 836466785L, -1975692626L, 586943319L, -608206932L, 
830535869L, 698730586L, -1924660717L, -858283976L, -1677318951L, 
1705215686L, 949025423L, -1553930364L, -1478551371L, -627246606L, 
39284939L, -1047879280L, -1480085423L, 791498206L, 1645846727L, 
2088163932L, -1902147667L, -682594678L, -275806589L, -1505337880L, 
386267849L, -1202780170L, -1566122497L, -1763395532L, 716580261L, 
-1721072094L, -918609093L, 2140419392L, -442309567L, 222893326L, 
1856344631L, -1791368948L, 1355993757L, 1075945658L, -1328470285L, 
1567197080L, -1325642567L, -693643994L, 1063165295L, 707900644L, 
81882773L, -910680494L, 5009835L, -1868057360L, 258741297L, -356276162L, 
-1770594393L, 1714656188L, 160029069L, 2096914154L, 1171514211L, 
-1868817080L, -674751831L, 255913558L, 1903114463L, -1261249132L, 
1605366661L, -2100772222L, -1356440549L, -1870651232L, 1491222561L, 
-359659666L, 757369111L, -1974537620L, -1242325891L, -1350325990L, 
-450970669L, -990306568L, -2130156391L, 627921798L, -649088945L, 
-1055706556L, -936332171L, 2090824370L, 1463018123L, 1503164496L, 
-175871983L, -1134480738L, -66744697L, -1489568484L, -1359013011L, 
840597322L, -151474109L, 375098536L, 438053513L, -2126510922L, 
-986250305L, -1141001484L, 523415909L, 1073688290L, 1671169275L, 
-1255425024L, 143756289L, -861263410L, -1305415689L, 492221388L, 
-1722067363L, -941366918L, -2056732493L, -413243816L, 2015521913L, 
1603011046L, -1591987409L, -1520607324L, -1991972267L, 1449850642L, 
-1723481237L, 188017584L, -1794593807L, 1956506878L, 1417522535L, 
-1210509700L, 1433881933L, -859648086L, -1405752029L, -1856197624L, 
-939906455L, 31738646L, 1723219615L, -1078118316L, 1589010245L, 
2049297218L, -2032656933L, 309266272L, 1839777761L, 707755054L, 
-1383938345L, 1554588972L, -276692931L, 1700415962L)
