.get_data <-
function(fit, data = NULL, complain = FALSE) {
    if(is.null(data)){
        if (complain)
        warning ("The `data` argument is not provided. Data will be extracted from model fit.")
        data <- eval(fit$call$data)
    }
    data
}
.onAttach <-
function(libname, pkgname) {
  # to show a startup message
  #packageStartupMessage("xmsPANDA v1.1.671 successfully loaded.")

  suppressMessages(library(RColorBrewer))
  #suppressMessages(library(data.table))
  suppressMessages(library(plyr))
  suppressMessages(library(parallel))
  
  #suppressMessages(library(extrafont))

}
.onLoad <-
function(libname, pkgname) {
      # something to run
      packageStartupMessage("xmsPANDA v1.1.69 successfully loaded.")
      suppressMessages(library(RColorBrewer))
      #suppressMessages(library(data.table))
      suppressMessages(library(plyr))
      suppressMessages(library(parallel))
      
      # suppressMessages(library(extrafont))
}
.Random.seed <-
c(10403L, 624L, -85822627L, -628155782L, 1667917235L, 1762690904L, 
-2139891335L, -1740027162L, -161175505L, 324276388L, -808605867L, 
-2138877934L, -464910229L, -1709101904L, 1216723185L, -1771416066L, 
797098599L, 1912334204L, -118117811L, -2136192854L, 307286563L, 
-1752756984L, 1071044457L, -547105770L, -926157921L, 441461076L, 
1302223941L, -1899731902L, -1331846437L, 307988576L, -510061343L, 
-2105137874L, 2055019479L, -1938803156L, 1590140221L, -1508769062L, 
-378840429L, -1188823368L, 343560537L, -311580346L, 1538202383L, 
1789357572L, 1454198069L, -2098756494L, 428923211L, -1387147248L, 
-1037800239L, -1115504546L, 634835271L, 116207836L, -934851539L, 
1277380874L, 201391875L, -1463657368L, 1589462857L, -1048982922L, 
-398123393L, -1604002124L, 1858697765L, 1823453346L, -1521833029L, 
-750844992L, 1617346753L, 718481294L, 732357303L, 1356715916L, 
-584861923L, -1660740806L, -15155341L, 1207772696L, -1497450183L, 
-279234650L, -2054881809L, -1437369500L, 495051541L, 480241874L, 
-206431701L, 1260266352L, -765521743L, 1521113790L, -1681633241L, 
74263100L, 1087102477L, 462715242L, 427400163L, 791632840L, -1940019415L, 
-811274026L, -1742358177L, 2046706708L, -567965691L, 1408969986L, 
778970267L, -357945568L, -1110680415L, -1174709778L, 197532055L, 
-1769592596L, -2106670851L, -746953830L, -206924717L, 1567882616L, 
-1220996839L, -1347815930L, 1117671631L, -1280296764L, 264464629L, 
-188449486L, 2028325643L, 1180575440L, 1210950801L, -1032248034L, 
117653255L, 114545564L, 217800685L, -1994925622L, -671962941L, 
-391771352L, -961546487L, 24987446L, -718945217L, 1584683380L, 
-450198043L, 834591074L, 1614810491L, 1635060352L, 113371265L, 
714521678L, 2123546743L, -1883166132L, 388020957L, -376448006L, 
844683571L, -1386183464L, 1105287417L, -1947081626L, 1035146159L, 
-1810520540L, 1424613077L, -1100136046L, 1264839659L, 1575606832L, 
-293066639L, 361176958L, 961256935L, 1450781948L, -1823616563L, 
-1161467350L, 10757539L, -16881016L, -2018756887L, -1701130858L, 
2013085471L, 824123092L, 156267461L, -15551038L, -352819621L, 
746034656L, 1145005153L, 1128091310L, 1136973655L, 451337132L, 
531735741L, 190547034L, 1113296403L, 1469758520L, -1095790375L, 
768279238L, -42252657L, -2065972348L, 1349338293L, 951203314L, 
-1453032245L, 1016675728L, -1939432367L, 1080838622L, 1616211143L, 
-407554468L, -163892307L, 1656040074L, 1757811331L, 135297512L, 
-984979767L, 714441718L, 895756799L, 22451252L, 202330533L, -1055997406L, 
449785659L, 747229504L, 2067583041L, -1769533170L, 1997823543L, 
-1034994420L, -593920355L, -252355398L, -957697293L, -403004520L, 
563853497L, -1966255834L, -458299025L, -346386204L, -1580885355L, 
782981714L, 1830780331L, 2034520304L, -457113551L, -71261122L, 
98085799L, 1524625340L, 339445133L, -1090577686L, 26242915L, 
95697224L, -243104087L, -1929024938L, -1642953505L, 175290772L, 
-354476155L, -1999962494L, -671324133L, 780385440L, -1397609439L, 
-2096364690L, -1875290857L, -1135456660L, 1246775421L, -562731750L, 
2134788051L, 1448622840L, -627191655L, -460271738L, 839253071L, 
1491734084L, 610984053L, 2003873458L, 214757003L, -1765600176L, 
-1232120815L, -870568290L, 260921991L, -61777636L, -2017015955L, 
-1715782838L, -667206589L, 1707190440L, -95644023L, -377323338L, 
515919807L, -1278505228L, -549986971L, 1935633122L, -1497886469L, 
-348301312L, -711493631L, 862201294L, 1659616247L, -347598900L, 
558760541L, -1544315526L, 1183730867L, 109806168L, -710027143L, 
-928154138L, 3702575L, -1964885084L, -271247787L, -166055150L, 
-1700475029L, 65898416L, -1127639055L, 35055870L, -1087669913L, 
-1000246660L, -1487603379L, 1224838058L, 368998691L, 34654216L, 
1235261033L, -1281046762L, 2460319L, -1866918828L, 1586596677L, 
-1444673726L, -1489360421L, 126788448L, -287001631L, -1641580498L, 
518230743L, -578256596L, -703943619L, -1652029990L, 336773523L, 
-932415048L, 2059653209L, 280714310L, 1174303247L, 1788549380L, 
1467759669L, -1715476622L, -992010165L, 463186704L, -1368929327L, 
-1169632418L, -1301608377L, 1466448860L, -2057430227L, -1360393206L, 
1189379L, 544839528L, -982088119L, -1425785482L, 1727673727L, 
1620265396L, 442771749L, 1634784162L, -1782926661L, 340762304L, 
-309207103L, -2048001394L, 1339611575L, -848584052L, -1728166371L, 
-1286955462L, -83646861L, -674029288L, -1378371527L, -497915226L, 
-703605521L, 225224292L, -354921963L, 1568263122L, -709631701L, 
614825584L, 1046605745L, -582357570L, -486275289L, 96318780L, 
-262525683L, 965524586L, -139574557L, 1926502088L, -809081303L, 
-617028650L, 1408651359L, 246558484L, 2602757L, -618803198L, 
-898520165L, -1906816480L, -1030292575L, 2035264750L, -578580329L, 
-1589021716L, 1453379581L, 1498637978L, 714668883L, -594053000L, 
-824078311L, -1358255866L, 1596237775L, -1263606844L, 1969313781L, 
1214242866L, -1285877237L, 1373831632L, 464520081L, 531773470L, 
-1498515961L, -877011300L, 1925263085L, -486433590L, 2047528899L, 
385369640L, 1183331849L, -1680164298L, -1546527937L, -1301429132L, 
961819877L, 1677917282L, 966202491L, -561994368L, 1525417857L, 
-756773042L, 194754423L, -344328884L, -1217771043L, -1883611398L, 
-301285325L, -359563304L, -1176938503L, 880547686L, 1811212975L, 
-843460316L, -24162859L, 1837769874L, -536038677L, -1037290192L, 
-246806671L, 35238526L, -1356704537L, 1370798076L, 1393238221L, 
828419370L, 543149219L, -1765923448L, -2085358103L, -1870544746L, 
256169503L, -1893856812L, 727818949L, 1429756098L, 1935863131L, 
1503703264L, -1618410655L, -1186684498L, 2044284503L, -363518292L, 
533902269L, -493385894L, -1399786221L, -2120665288L, -961081383L, 
2084484550L, 1664654735L, -236622204L, -908446795L, -334456590L, 
2046870475L, -2141644656L, 1713896273L, -786932514L, 169321415L, 
-335134372L, -1817181523L, 918678922L, -1612367485L, -402803480L, 
1564583369L, -1463421194L, 721895679L, 337313588L, 2009596069L, 
332784930L, -1542638021L, 1083206720L, 1969614657L, 520610830L, 
603215159L, -2009921524L, -1336799843L, 1778573242L, -379348493L, 
-1920557416L, -915228743L, -605387738L, -2019049361L, -427181084L, 
1455032725L, -284476078L, 997147819L, -2092848144L, 490856241L, 
-1522124994L, 558260903L, -1694074180L, -215493491L, -1858249238L, 
-908913053L, 1821307976L, 623461801L, 541023574L, 1741757407L, 
-591616876L, -67154299L, 284402050L, -1815220453L, -1071130720L, 
-1116026079L, -1027189138L, 1638190103L, 1533778284L, 1163941757L, 
-904632294L, 1136307923L, 1714533880L, 302272409L, -183008634L, 
-134589617L, -1661028028L, 1621544821L, -1382936142L, 2056271243L, 
-1380061360L, -1248873711L, 1664827806L, -1167683193L, 185426972L, 
-336947603L, 1793785418L, -1956551869L, -230038616L, -1453140599L, 
2122707894L, 307914431L, -1336215052L, -780170139L, -911634974L, 
-1495459845L, -247532800L, 1421842177L, 790100174L, -425544969L, 
-1504257332L, 2004193629L, 853811322L, 1993225139L, -814580392L, 
1818482553L, -1252151066L, -1360505297L, 849110692L, -552041131L, 
1790776850L, 698062443L, -827989328L, -905349391L, -1148224514L, 
-147836825L, -1804403332L, -1267709875L, 2044907178L, -305651677L, 
-1291418872L, 870733161L, -1758348778L, 1398481311L, -2108817580L, 
1304476229L, -955274686L, -579686181L, -659702176L, 338449121L, 
-1164653778L, -1029305897L, 1464650796L, -1693861059L, 1619658970L, 
1507207315L, -115280712L, 545869657L, 1448415046L, -2094413553L, 
-256195580L, 92744501L, 1973701234L, -691443893L, -1596881392L, 
-240702767L, 718988894L, 1432043335L, 999245532L, 1060170285L, 
3985162L, 373247235L, 1419563624L, -1968454327L, -1982156682L, 
797658239L, 1911403700L, 37410853L, -1640106334L, -741951045L, 
1733048768L, -793182527L, -2016096882L, 1634128055L, 145059212L, 
-1063987939L, -1692524230L, -536179341L, 2132089880L, -227756231L, 
1570086310L, 662088687L, 1286721892L, 1131069717L, 694136530L, 
-1403934677L, -887563920L, -1084174671L, -105545538L, -1365262809L, 
-1329971140L, 983858189L, -871301270L, 1174333923L, -387657272L, 
-273996503L, -1038559530L, -2019367073L, -896394732L, -1134172667L, 
-263425278L, -1039060325L, 2045928736L, 1532861089L, -2056257554L, 
-1969420393L, 12107500L, -1265705219L, -1229428326L, 413360723L, 
1764160376L, 570822425L, -1665704954L, 713490127L, -405172540L, 
1144735477L, -318291150L, 1886148875L, -531374896L, -1037147503L, 
1018645278L, 951430407L, 1347152284L)
