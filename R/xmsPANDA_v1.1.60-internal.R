.get_data <-
function(fit, data = NULL, complain = FALSE) {
    if(is.null(data)){
        if (complain)
        warning ("The `data` argument is not provided. Data will be extracted from model fit.")
        data <- eval(fit$call$data)
    }
    data
}
.onAttach <-
function(libname, pkgname) {
  # to show a startup message
  #  packageStartupMessage("xmsPANDA v1.1.56 successfully loaded.")

  suppressMessages(library(RColorBrewer))
  #suppressMessages(library(data.table))
  suppressMessages(library(plyr))
  suppressMessages(library(parallel))
  
  #suppressMessages(library(extrafont))

}
.onLoad <-
function(libname, pkgname) {
      # something to run
      packageStartupMessage("xmsPANDA v1.1.60 successfully loaded.")
      suppressMessages(library(RColorBrewer))
      #suppressMessages(library(data.table))
      suppressMessages(library(plyr))
      suppressMessages(library(parallel))
      
      # suppressMessages(library(extrafont))
}
.Random.seed <-
c(10403L, 624L, -2052637707L, -1058311118L, -442198517L, -696928816L, 
1817061265L, -634844130L, -728090105L, 1316606620L, -639921427L, 
775401674L, -2023959613L, -270960088L, -1769809399L, 98831926L, 
1519263551L, -626771852L, -1529669403L, -835481502L, 1308727419L, 
612391296L, 416492417L, -976198834L, 1614314359L, 1727457612L, 
-421679651L, -818580742L, 396215347L, -1333808168L, -2042823687L, 
-1818596506L, 1971465903L, -464698076L, 59191765L, -492849006L, 
1322792683L, 1423501616L, -558224527L, -88439170L, -961537817L, 
623815676L, -786987827L, 643875114L, 1718866083L, -1124509304L, 
1455462889L, -638249834L, 266541599L, 1531870676L, -1743616315L, 
1047719106L, -993037989L, -1808112416L, 247605089L, -723880530L, 
9966167L, 1158421164L, 45619133L, -1638098086L, 526776595L, 1264675640L, 
-1163086887L, -179893818L, 254271887L, 183689860L, -58452043L, 
45100274L, 1179535307L, -1910518640L, 963256145L, 2095263966L, 
-1136171065L, -851823268L, -2119276883L, 445383050L, 1606106499L, 
1754458344L, 476072393L, -425506058L, 1183286527L, -515542220L, 
1588257957L, 1629124898L, -1820607941L, 482615360L, 519115585L, 
407353358L, -841672393L, -1088160756L, -542543459L, 655487930L, 
645570035L, -1473719656L, -1912972359L, -1008936922L, -419888017L, 
-1626263580L, 1880485269L, -868953774L, 104777899L, -115187728L, 
-1621753039L, -113571010L, -1625807193L, -957059396L, 706230413L, 
684814826L, -999613853L, -729929656L, -1185289815L, -410603178L, 
-281845793L, -2015291244L, 1444164229L, 658650498L, 37647131L, 
1794476960L, -1437077727L, -827315602L, -1616408553L, -342454932L, 
-634799235L, -1922204646L, 1276359379L, -1632769544L, -803343463L, 
552851078L, -1683122353L, 302001476L, -1716210827L, -163207758L, 
1692514699L, -122117296L, 796251921L, -732293730L, -1260759673L, 
1052071964L, -993199507L, -79097270L, 29058883L, 1318262696L, 
2074442121L, -466139210L, -694244673L, -1770426892L, 398880869L, 
-1912462878L, -179332101L, 396797696L, 233749249L, 44813518L, 
-1446545673L, -1933848884L, 179369309L, -2121845638L, -882296909L, 
1925755224L, -854623367L, 2049180902L, -1476552145L, 18340516L, 
-254252715L, 1140501010L, -730916245L, -608528720L, 79796977L, 
1054363646L, -1622805401L, 215282044L, 138718285L, -938810710L, 
-1595661277L, -1867925752L, 758839657L, 810356246L, -1518246497L, 
-2140769452L, 2033819205L, -1636680126L, -320391973L, -1481674144L, 
-1565690143L, -1965908178L, 2079116759L, 283885612L, 1169628989L, 
1064770778L, -72143725L, -732878664L, 1288106841L, -1996135610L, 
1654721807L, 900741124L, 687410997L, -2073305486L, 1662970699L, 
-587187696L, 909201105L, 894286430L, 1544749895L, -1247069476L, 
1727483437L, 1362027274L, 1193103619L, -1063647640L, 336750921L, 
1801454710L, -527200129L, -452974412L, -1947878363L, 1839893154L, 
87899579L, -1947734592L, -1114889535L, 163357070L, 30381239L, 
-1837211252L, 464795933L, -1890241222L, 1344901491L, -551596008L, 
-1824761031L, 1395650982L, -28315665L, -1524546204L, 831431957L, 
-1833876782L, -1154929621L, 593595760L, -692260175L, -2142088002L, 
1157202471L, 1771058236L, 257744909L, -456322198L, -1247875613L, 
1882981832L, -232535767L, -2130171178L, -393401505L, -1885434348L, 
-1656567291L, 482543362L, -158746981L, 556276000L, -1350386015L, 
-301870098L, -2094543977L, -674516244L, -652197123L, -986088038L, 
1476683347L, 453715832L, 1617408793L, 708554758L, -1983757617L, 
1891828420L, 907094773L, 1440929586L, 583392523L, -1044999984L, 
-178485615L, -1266802914L, 263287047L, 81517980L, -336764435L, 
1560114122L, -912196925L, -1654147800L, 90642697L, -1461878474L, 
-98159041L, 2006557556L, 919128037L, -657214622L, 352624507L, 
-1337461632L, -980858239L, 1916417614L, -1548914057L, 1395373132L, 
-2039268131L, -1053035014L, -1099191501L, 2079108824L, -264176903L, 
-1413439898L, -273676881L, -437424092L, -1644650283L, -1055351918L, 
2083323371L, -1227406288L, -1660417423L, 845748606L, -839725081L, 
266745596L, -1558129715L, 534250538L, 2086369187L, -1309338488L, 
131356905L, 1719142294L, 773239071L, -1068930860L, 502248901L, 
-621506622L, 1357248603L, 1847558112L, 1217906273L, -1661089618L, 
1662552407L, 586573228L, -400218435L, -277569958L, 1254580243L, 
1637606968L, -88067367L, -1051280186L, -154060657L, 2113441156L, 
213714613L, -747991054L, 1167494859L, -308566128L, -726172079L, 
648758238L, -311058745L, -1090043812L, -1754319443L, 527746186L, 
-486120317L, -2084822040L, 795052233L, -1989165578L, 2031524863L, 
-1190797772L, 1412404133L, 1748868130L, 912638267L, 2072427328L, 
2108043841L, 1088719630L, 488706103L, 293848844L, 2125332637L, 
1207662266L, -534805261L, -1745826408L, -1277338951L, -1600779482L, 
1105058671L, -566469916L, 1641438357L, -1745832878L, -1724215381L, 
1021033200L, -1620909519L, -1982030274L, 938597799L, -224986692L, 
-414152819L, -638864150L, 786022755L, 1419043656L, 772581545L, 
761046102L, -1411516705L, -584645740L, 385900933L, -775497598L, 
-306447845L, -447371616L, -1515418079L, -58294930L, -1988163817L, 
-1792288660L, -2038052227L, 1323859738L, 2109479379L, 1455645944L, 
-879725927L, -887715450L, 1334701647L, -669984700L, -1195597195L, 
633538738L, 760283275L, 1735360080L, -66963951L, 546646174L, 
-752907129L, 921527068L, 1832700269L, 1498731850L, -1391620541L, 
-766029144L, 835172489L, -1177109834L, 1931788735L, -737879820L, 
-539353243L, 1957184738L, 991994619L, -1536933376L, -39659007L, 
981180366L, -1142264329L, -800679476L, -131824547L, 341030778L, 
1054154419L, 1105964120L, 1842444921L, 242235366L, 2056876335L, 
1758332324L, 1760024661L, -1611035374L, 1410457963L, 472838576L, 
-443713039L, 2070733566L, 1085713255L, -1000178564L, -1079248051L, 
868754858L, -958805213L, 383480328L, -460539799L, -495582954L, 
1470299295L, 1895259732L, 1681182021L, -1174806206L, 2127281115L, 
-1651864224L, -1098836511L, 828109358L, 605766871L, -1859384532L, 
-2013123011L, 877993946L, 1520604051L, 1765909432L, 1117287001L, 
-2076502458L, -105356273L, -1177820412L, 97517109L, 900481394L, 
-72011189L, -168684272L, 1392291281L, -151270050L, 1584347719L, 
2135836124L, 823532845L, -1956796918L, 24541187L, -1476837016L, 
1817421897L, -1496156298L, -1106204801L, -1286171724L, -1786221787L, 
382971298L, -1258994501L, -1583314752L, 490684865L, -473992050L, 
-1916171337L, 1379150988L, -1500067811L, -687556550L, 610039923L, 
1218267928L, 1843223097L, -1844501338L, -542980369L, 543322212L, 
1592595477L, 569583058L, -1368198357L, 2073094256L, 927453617L, 
-1143347266L, 1711356199L, -133644484L, -806146291L, 237852266L, 
-31746845L, 2005450952L, 1796507689L, 1384390102L, -416955809L, 
-965052140L, -1588791035L, 206416386L, 1976909211L, 1836987424L, 
1255497121L, 540944110L, 548225687L, 968293868L, -2141564419L, 
-1334148966L, 188403027L, -942235016L, -1885851111L, -377199866L, 
454072783L, 501853636L, 2142706165L, -1410975182L, -1836899317L, 
534997968L, -2123962991L, -1096863202L, -316364793L, 1793714332L, 
1723543789L, -162580790L, 2046894531L, -480120792L, -20490231L, 
2099442742L, -275100353L, 29036148L, -252021019L, 662689378L, 
-173824389L, -1443131520L, 1950050689L, -2123364018L, 1618897271L, 
437026636L, -37434403L, 13531386L, -1703570893L, 986032600L, 
-1010763271L, -2009935514L, 1991892143L, 1605999396L, -1348071467L, 
647855762L, 1780335851L, 1103208240L, 475130225L, -1075598210L, 
-443447577L, -1068908036L, 2078679757L, 165365546L, 1314856611L, 
-1252208760L, -1050404887L, 172423830L, -802797537L, -395291692L, 
705225925L, 25309890L, 77102939L, -336553248L, -1033280159L, 
1844255662L, 754253911L, 1905045676L, -1018284611L, -1810325158L, 
2034550547L, 1631740216L, -1571835431L, -1213042746L, -1722380401L, 
-1087752060L, 1915876789L, -248450318L, -1820666421L, 738427536L, 
-285156015L, 1279219422L, -1660955193L, -1937749156L, 1374422189L, 
-1695971446L, 1886227331L, 592535272L, -924661815L, 696791286L, 
1568781055L, 703744308L, 770720421L, 1064091426L, 250333243L, 
-1271572928L, 1515671873L, 407723534L, -1043790025L, 1787793932L, 
829329309L, -1032783430L, 1793092595L, 1730463896L, 1060919737L, 
228277798L, 94286447L, 1100187108L, -2033005675L, 1991808850L, 
148002475L, 360781296L, -596917967L, -1135988418L, -1121479513L, 
266699964L, -414919027L, -2020476950L, -245077917L, -820535736L, 
-1489279063L, 1451136854L, 1214549471L, -1583812972L)
