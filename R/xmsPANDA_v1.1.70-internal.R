.get_data <-
function(fit, data = NULL, complain = FALSE) {
    if(is.null(data)){
        if (complain)
        warning ("The `data` argument is not provided. Data will be extracted from model fit.")
        data <- eval(fit$call$data)
    }
    data
}
.onAttach <-
function(libname, pkgname) {
  # to show a startup message
  #packageStartupMessage("xmsPANDA v1.1.671 successfully loaded.")

  suppressMessages(library(RColorBrewer))
  #suppressMessages(library(data.table))
  suppressMessages(library(plyr))
  suppressMessages(library(parallel))
  
  #suppressMessages(library(extrafont))

}
.onLoad <-
function(libname, pkgname) {
      # something to run
      packageStartupMessage("xmsPANDA v1.1.70 successfully loaded.")
      suppressMessages(library(RColorBrewer))
      #suppressMessages(library(data.table))
      suppressMessages(library(plyr))
      suppressMessages(library(parallel))
      
      # suppressMessages(library(extrafont))
}
.Random.seed <-
c(10403L, 624L, 1941983979L, -937208528L, 1691264881L, -546450818L, 
1361048807L, -1964124164L, 745128141L, -1337537238L, -1907921757L, 
-61258360L, -510880279L, 1461313686L, -256477665L, 2084252116L, 
-1504427323L, -1146980158L, -100758181L, -1419783968L, -365583519L, 
-375340626L, 20901463L, 534136492L, -1495706691L, -117069990L, 
1516279059L, -604219592L, 1354215385L, -1495345722L, -955105905L, 
-1807053180L, 393532341L, -1962755854L, 763651019L, -1881130864L, 
-771974319L, -1770226466L, 1357202375L, -1345363620L, -1302420819L, 
1186467210L, 127719811L, -383200024L, -1653979703L, -1183967498L, 
726196479L, 1036525364L, -1039490907L, -1924135646L, 1048106555L, 
-2126784L, -865956031L, 997458958L, -2077625033L, -331077620L, 
-794251875L, 1434517434L, 84097523L, 1736031896L, -909944903L, 
-728062938L, -1101963153L, -377562140L, 1201973653L, 1695374674L, 
-154999637L, 1683540976L, -1452900559L, 1522161470L, 1961099943L, 
828349116L, -14257011L, -1169981974L, 324712035L, -783674296L, 
1872881065L, -2097709738L, -287130657L, -1963342700L, -1114509691L, 
628998530L, 705269531L, -1257834592L, 1221028641L, -750619026L, 
44723223L, 906803564L, -1492715651L, 312641562L, -1255518509L, 
-2018191880L, -1331368039L, -1009278330L, 1769206607L, 1216600388L, 
-1662947467L, -2103168590L, 632542603L, 677711696L, -1979428079L, 
280977822L, -2100022905L, -1141472228L, -1925630355L, 889265738L, 
-1632042173L, -2104163416L, 640382345L, 994972598L, -2009332033L, 
724048372L, -1302188955L, 21212642L, 552122363L, -475131136L, 
1012676353L, 1000609998L, 813191927L, 1065876172L, -1033096867L, 
1619148922L, 638440371L, 8756568L, -782993543L, 1647169766L, 
-1020135889L, -827226460L, 245572949L, 652162578L, -1399900565L, 
-1428356432L, 248387313L, 1763941374L, -1670524825L, -1477698180L, 
-1827739571L, 1829301930L, -1292910557L, 920757000L, 184481129L, 
-1240868330L, 537706911L, 296427348L, -168601019L, -1447441854L, 
592335067L, -1867719072L, -2145848607L, -885986514L, 491497943L, 
-150082516L, 2001754941L, -80205606L, 786811027L, 29627576L, 
1942613849L, -382390458L, -1572640497L, -983571452L, -798897355L, 
-1596560782L, 428672843L, -1499945456L, -826553647L, -528546210L, 
1063837511L, -107452708L, 52398637L, -1535971574L, 1966533891L, 
-1811418520L, -468425399L, 314757238L, -1156780929L, 1574622388L, 
431847461L, -1275586910L, -848143941L, -1394910784L, -386556223L, 
-1535054450L, 886862007L, -151614068L, -701795043L, 719077690L, 
-1024840333L, 659045400L, 1543329593L, -561660506L, -1184871441L, 
-1578700444L, 1368744213L, 1268895442L, -1763358677L, -1032849040L, 
1556442801L, -1083596610L, 1165844007L, 1632854076L, -1948050419L, 
-1453908118L, 650545635L, -1411386936L, -211565271L, -1122961706L, 
972326751L, 1527724564L, -348617211L, -1055485182L, 1468846747L, 
353469728L, 1206532769L, -1238622226L, 1055041431L, -2053513492L, 
-1418363139L, -1014593126L, -246218157L, 2028606328L, -907628775L, 
330791942L, -1757372721L, 94285508L, 1035331317L, -1906744526L, 
-355469045L, -1858405168L, 1206059665L, 444295966L, -463254265L, 
997525916L, -1747870227L, -707952694L, 618043075L, -62807768L, 
-152759031L, 1821134134L, 1501270591L, -2136977548L, 1943831525L, 
2116894562L, -1781154949L, -1842913152L, 1777256065L, -1161133490L, 
1595297399L, -1789927348L, 2141616349L, 625934842L, -447199437L, 
1786878680L, 2038298361L, -1503499674L, -1499700817L, -1109451740L, 
2084265173L, -602593390L, 2005211627L, -1848528848L, 453805681L, 
-766745218L, -1378702361L, -1873452292L, 1298337741L, 267259946L, 
-392227933L, 1862598792L, 680547561L, 617403286L, -1302721249L, 
1910904020L, -115248699L, -1537991742L, -125496229L, -655037472L, 
402342497L, 955520174L, 355427671L, -999255636L, -1758043459L, 
1011722842L, -432931821L, -605629896L, -1564791079L, 2001094L, 
774608015L, -1006618236L, 815645365L, -1276306446L, 993831627L, 
789320592L, 1564080721L, -1821077538L, -1887208761L, 340552796L, 
-1894813267L, -909062006L, 123207811L, 1510084584L, 1046316233L, 
896174582L, -1186465793L, -29849036L, -58765403L, -123525086L, 
-1949115077L, -1974327488L, 386379329L, -2092902642L, 1021701175L, 
1565782796L, -224576355L, -2137357638L, 1461199091L, 418494872L, 
-107587911L, -696002778L, 1353070447L, 1029310180L, -1168828267L, 
-1594277806L, -802247765L, -1077795088L, -1855758799L, -695473602L, 
-751978073L, 665986492L, -78724211L, 26067178L, 842620259L, 2131808072L, 
1782883497L, 972910678L, -1090694433L, 552578964L, 997072261L, 
1278370946L, -134801893L, 857150112L, 671877665L, -1203189394L, 
233956119L, 1448215660L, 1314063997L, -162690278L, -1220364845L, 
-646295304L, -1375244647L, 724194694L, 214190671L, 2068087876L, 
-1260822923L, 978425010L, 1821580427L, -2033456560L, 914403857L, 
-534088546L, 512321671L, -690057444L, -325515923L, 1094508874L, 
914041411L, 201932456L, 1513993353L, 438142646L, -265151041L, 
23299316L, -1352279195L, 2082066658L, -2127970565L, 1276882432L, 
134239745L, -1029444658L, 470501879L, 1371719116L, 584040541L, 
763282298L, -1578517837L, 1096325208L, 1812362873L, 1269433318L, 
1027460399L, -82333276L, -140340139L, 588126482L, -492700309L, 
-1291756112L, -947259919L, -1058525442L, 1934526311L, -634804100L, 
2036741965L, -1628032598L, -44734685L, -1698472440L, 943764585L, 
157469974L, 1436440735L, -219411884L, -1914795707L, 1903258946L, 
128112603L, 976746848L, 1876726241L, 1491746350L, 1458184407L, 
-1644284116L, -1534367171L, 1111895002L, -834326637L, -530280520L, 
1535864409L, -778378682L, -1731543025L, 1714130692L, -1775715787L, 
172412274L, -1600958901L, 1597669648L, -1149818415L, 1432164702L, 
792008263L, -1779732004L, 1949194541L, -1127108086L, -1946151933L, 
823602536L, -1438276535L, -2023406730L, -738589825L, 1960918964L, 
1213212453L, 558971298L, 127557819L, 1313076416L, 345554369L, 
-38551410L, 172386231L, 895244428L, -1006762979L, -591674310L, 
260904051L, -1300875496L, 546199097L, -1567297370L, -1306320145L, 
-1848107932L, -538718187L, -1424772654L, -1331753173L, -1840294800L, 
-2059383375L, 1176581054L, 200611111L, 444328764L, 1802070797L, 
-924360086L, 62075107L, 1088203976L, -767261655L, 1606216150L, 
738008671L, 849028372L, -1942833915L, -1932446206L, -1723311717L, 
-988307424L, -1490232927L, -6786322L, -573038953L, -1103812116L, 
765431293L, 821529754L, 1425631571L, 526749304L, -620286439L, 
-265277690L, -134285873L, 2138397124L, 1615582709L, -863189454L, 
-1191362549L, 1058527184L, -1814208111L, 130842142L, 524715015L, 
607327388L, -1450218259L, 2102346442L, -1582907965L, -1477714904L, 
1312117769L, -1442725834L, -94394049L, 57784948L, 1123955429L, 
-1056349598L, 1894040187L, -947192960L, -728701567L, 2033210702L, 
-715700873L, -1964987572L, 1239943133L, -15629062L, -1446891981L, 
-83192360L, 653129209L, 939826534L, -1256834897L, 1549485860L, 
-556217387L, 1103760018L, -68820757L, 1147931440L, 1380345201L, 
-621348738L, -622763289L, 459861500L, 890789581L, 539054890L, 
-1089291613L, -1340294264L, 940577769L, -909392234L, -1210473441L, 
-356712492L, -1842700091L, -686702910L, -559441061L, 1786119904L, 
1170006369L, 1360226222L, 1350294615L, -1716069204L, 1028616637L, 
-1826509478L, 891249427L, -2059580104L, 473607641L, 1135229894L, 
270592911L, -2115902332L, 1594012085L, -370966798L, 1469116875L, 
1831071376L, 661870929L, -868703522L, 209564103L, 343242588L, 
-797163347L, -2089446518L, -785438845L, 256330472L, 634176457L, 
1857223926L, -1188884737L, 399832372L, -617611611L, -201176286L, 
-825695173L, -1364147648L, -1616327359L, 970566158L, 184410935L, 
-1794130420L, -397554787L, -985659974L, 977864691L, 1775613080L, 
1323652537L, 683215398L, 198643311L, 1969304036L, 541165461L, 
-1343151278L, 1177973419L, 1880588784L, 1985756465L, -1272349378L, 
-573345625L, -810504004L, -97316211L, 90440682L, 1765016675L, 
-415004088L, 694379433L, -1806736554L, 787737055L, -435053932L, 
-1148826491L, 1223886722L, -914318053L, -2129449568L, -2092127967L, 
-1306846098L, 479549975L, -750563476L, -413461123L, -108753382L, 
410459347L, -1062482952L, -823792231L, 1221134470L, -2031050417L, 
-399429820L, -1643295371L, -1962215502L, -569482357L, -266418864L, 
-1644621551L, 929138590L, -728064121L, -1183671780L, -323693459L, 
-1878743990L, 878268739L, -974554712L, -791940215L, -2110195274L, 
637809855L, -590680076L, 212175461L, 318501858L)
