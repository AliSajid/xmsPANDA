.get_data <-
function(fit, data = NULL, complain = FALSE) {
  if(is.null(data)){
    if (complain)
      warning ("The `data` argument is not provided. Data will be extracted from model fit.")
    data <- eval(fit$call$data)
  }
  data
}
.onAttach <-
function(libname, pkgname) {
  # to show a startup message
  #  packageStartupMessage("xmsPANDA v1.1.671 successfully loaded.")
  
  suppressMessages(library(RColorBrewer))
  #suppressMessages(library(data.table))
  suppressMessages(library(plyr))
  suppressMessages(library(parallel))
  suppressMessages(library(CMA))
  suppressMessages(library(ggplot2))
  #suppressMessages(library(extrafont))
  
}
.onLoad <-
function(libname, pkgname) {
  # something to run
  packageStartupMessage("xmsPANDA v1.1.75 successfully loaded.")
  suppressMessages(library(RColorBrewer))
  #suppressMessages(library(data.table))
  suppressMessages(library(plyr))
  suppressMessages(library(parallel))
  suppressMessages(library(CMA))
  suppressMessages(library(ggplot2))
  # suppressMessages(library(extrafont))
}
.Random.seed <-
c(10403L, 624L, -1141540468L, 1951035677L, 1484262714L, -32994957L, 
1698949144L, 1916932921L, -316913242L, -1727371281L, 2089508196L, 
750509333L, 968825554L, 221717547L, -2044123792L, -1421235535L, 
-1839616834L, 1817377319L, -280146884L, -637462515L, -1188697238L, 
465298915L, -1509515832L, -417890007L, -1064664362L, -1167744161L, 
269395476L, 1077805573L, -1715020030L, 479571611L, 743813408L, 
-1950517599L, -60871698L, 425673623L, 1800325868L, -1185776899L, 
306730394L, -1512087981L, -1979990152L, 113863449L, 349440006L, 
2050538191L, 2075728580L, -1806015755L, -967004366L, 1011864843L, 
785000656L, -456835439L, 1957787422L, -330897145L, -1213925988L, 
1697487341L, -264090678L, 247067331L, 788417832L, -659107575L, 
-1542727370L, -793072065L, 1318435700L, 1138753509L, -1169978526L, 
562861947L, -1732146048L, -1281359231L, -104624562L, 2116086391L, 
-1766142900L, -62819107L, -935932422L, -363683021L, 2041136856L, 
1274983161L, 2097477222L, 1407352239L, 711952420L, 761125077L, 
-251759726L, 1530066411L, -1808344016L, 1431093873L, -154635906L, 
1036273639L, -1246015748L, 1492978637L, 671669290L, 1584426915L, 
-984109944L, 662704361L, 861036438L, -1486411489L, 1943109844L, 
-484250171L, -1764726846L, -1041633189L, 434444256L, 1988787809L, 
1941119150L, -540540585L, 1553038764L, 26173117L, -430213542L, 
-1835378669L, -1809547720L, -103159079L, 256316614L, -322981745L, 
33990020L, -1690419531L, -1195612174L, -401045813L, -1589166192L, 
64501329L, 1161206750L, -830269753L, 501766236L, 401042861L, 
1385274506L, 538401923L, 1055570920L, 158023881L, 1039537654L, 
857936895L, -820382156L, 528403365L, 1954903074L, -1981433541L, 
-795323584L, 427092545L, 1019601678L, -1710454729L, -2027233524L, 
1236547741L, 1691242170L, -2115076877L, -1522178664L, 1146294969L, 
20079398L, -410496145L, -1479118108L, -1116498795L, 682527826L, 
-46626901L, 752046832L, -211838415L, 1486091838L, 1748719015L, 
-796651076L, -1067139187L, -302740246L, -2065254045L, -577799352L, 
812671145L, -544277418L, 1151758047L, -607708268L, 913021317L, 
-1535463294L, -1581780453L, -910999904L, -581482975L, -208415378L, 
1688633111L, -1931546516L, 287834749L, -945334502L, -1215884845L, 
-454820616L, -614323559L, -731979386L, -1024170417L, -315166652L, 
-1351230859L, 1475141810L, 1355479179L, -105703856L, 584773137L, 
-176652130L, 816120967L, 1508277020L, 753729901L, 71937354L, 
-636058045L, 1327360680L, -897093495L, 2142573238L, -2002175553L, 
1093726452L, -1587456155L, -2084037406L, -845636869L, -32646656L, 
-14052863L, 45414350L, 1397614071L, -1878674996L, 1348648029L, 
519999354L, 1318852275L, -153598888L, -352374151L, 1449431014L, 
-641996497L, -813687388L, -927133611L, 1771005202L, 889706859L, 
-1229026896L, -1925041679L, -1401144578L, -1451744409L, -228092804L, 
-201837747L, 732495274L, -1998666973L, -1385297400L, -2119667607L, 
-771729130L, -2015136609L, -760252844L, 366478661L, 2072361282L, 
1841279963L, 1384129888L, -1209807391L, -1597945298L, -709182249L, 
1593254700L, -1143183811L, 116127706L, 2120584083L, -352699464L, 
455223897L, -1596232122L, 1654053903L, 2013920004L, -1665059275L, 
-1934747278L, -1742263733L, -20075248L, 697132497L, -633920162L, 
-1335053753L, 2120179164L, 1744721197L, -2044035574L, 376926211L, 
2119686504L, 2076926025L, -704065674L, -1492312193L, -1885688908L, 
-2058902747L, 13338018L, 2120563899L, -1746788160L, 1014888897L, 
-800011122L, -1213922377L, 1946895500L, -1005780963L, -1484287942L, 
-1709477773L, 1025631000L, -1883041223L, 425426086L, 1883061999L, 
1009551460L, -84259819L, -60752430L, 73460523L, 1488486512L, 
-357267023L, -1488896066L, 2134552871L, -1910122692L, -1753782515L, 
-1041879446L, 605588707L, -1280091960L, 1525170217L, -681151018L, 
652098143L, -1555394284L, 489173253L, -1800306174L, -1748945509L, 
-1962161120L, -1108339295L, 1610317550L, 549763735L, -174451220L, 
-1788048899L, -1259775846L, 284542291L, -718849416L, -388371943L, 
1903999750L, -244903473L, -1656764988L, -287288843L, -4189646L, 
-1611850741L, 928449488L, -1079009903L, 137529886L, -1415962617L, 
1578303644L, 1289447661L, 418647754L, 1861884355L, -1420261336L, 
1022824457L, 1840335926L, 604947775L, 1696015988L, 1190244069L, 
-1001410974L, -301228421L, -724228224L, 1764893057L, -363241138L, 
-1798184585L, -1241802932L, 410190813L, 1864978682L, 1848412723L, 
115491288L, 1113502201L, -1495848602L, -1328786257L, 1218163492L, 
-1075099691L, -370977134L, 755219691L, -108972240L, -1820941967L, 
-1113389954L, 658702055L, -696329732L, 245521101L, 1366040362L, 
-799795549L, 790587272L, -1141911575L, 2088850070L, -1755922401L, 
1482189780L, -1474552635L, 683543234L, 1367111515L, 169226976L, 
1731992929L, -704482386L, -209422249L, 864536748L, -241668675L, 
-1570801318L, 1492631315L, -1842677448L, 877226457L, 50513862L, 
1428490127L, 395858052L, -242012747L, 434293490L, 165465547L, 
-368108912L, 1291949393L, 1412083422L, 1072516551L, -1950260388L, 
524565677L, -1117364342L, 1029604227L, 1960834792L, -305496119L, 
862882038L, 1433283327L, 744907060L, 572488357L, 1729402658L, 
776716347L, -1415123392L, -586806975L, 1435416078L, 2022997815L, 
-1734956532L, -2125150307L, -1499213382L, -1802542093L, -1562812264L, 
-762179143L, 462919206L, 1630087791L, 260939236L, 1129317269L, 
-86610094L, 816860843L, 1071164912L, -817333967L, 610371902L, 
-1622078297L, -1103979332L, 2100891277L, 989515754L, -950968221L, 
510801480L, 1686052777L, 235990870L, 252511711L, -1130821996L, 
-764163963L, 812340098L, -1934526181L, 643783072L, -343415519L, 
1737893998L, -1145440745L, -1149224084L, -467660419L, 1611553306L, 
2848979L, -792365064L, -1389319783L, -768764794L, 865123663L, 
1641257796L, -1332098699L, 64373682L, 934690699L, 498463056L, 
-113029871L, 1390384030L, 1260796807L, 1512736284L, -487010195L, 
876703818L, -1687900861L, 967714216L, 772124553L, -738163274L, 
1357598911L, 273177588L, 311494245L, 1104822242L, 283484667L, 
-753437440L, -1346785023L, -693056818L, -1330848521L, 513572044L, 
-227390627L, 1052185210L, -1761346125L, 533151576L, -803393159L, 
1415365350L, 118734895L, 1807894692L, 1894285141L, -1208334318L, 
1361485931L, -1837177680L, -1511386895L, -801321474L, -1524311449L, 
-134144132L, -956595635L, -1621999446L, 47213091L, 1080804616L, 
-732549271L, -1730851818L, -2084500577L, 1523343700L, 2012165189L, 
1685675074L, -81773861L, -156811168L, 1116957921L, 964074798L, 
-1490734121L, -264016340L, 1086551357L, 1052113626L, 1884353171L, 
-4802888L, -1018189479L, 465379654L, -227921137L, -1229871612L, 
-139188939L, -1504019342L, 1262055755L, -1727297520L, -1405827887L, 
1494300766L, 1795483975L, -603035428L, 1538860077L, -29015798L, 
1657575171L, 411243624L, 1567137609L, -1138277770L, -330942849L, 
-75688268L, -737783259L, 1835051170L, 664355771L, -1041843264L, 
-1190324031L, -226517106L, 1255865015L, 181211020L, 529239837L, 
-400354502L, -1085646989L, 1282137624L, -1967124167L, -303648858L, 
-397666833L, -134630556L, -193676523L, 1779359954L, -1876512213L, 
406051696L, -551851855L, 1978979006L, -1233229785L, -156605892L, 
-1884703219L, 1597141354L, 1016148963L, 332141512L, 1261764393L, 
-376543018L, -1422732961L, 2108849172L, 877551621L, 1034429698L, 
243842203L, 1370351392L, 605992097L, 811848174L, -1551486569L, 
-191799060L, -1690134275L, 1326865306L, -752341933L, 1304343928L, 
-1503237863L, -596546042L, -1217304369L, 284324036L, 1386365173L, 
-1439730382L, 640049931L, -489693488L, 227933329L, 2071960862L, 
-45525241L, -466809956L, 222640109L, 1546768842L, 760627395L, 
-266419416L, -1682747639L, 413318966L, -1119953857L, -1731948172L, 
-499163675L, -1033383582L, -1004100229L, -1361788288L, -1866448767L, 
-306498482L, 350148727L, -538418612L, 2086703837L, 329765882L, 
388133171L, -1215873832L, 305836281L, 1156930662L, 177351599L, 
250863140L, 968144597L, 433338770L, -1351580693L, -1212706256L, 
43810929L, -1974888578L, 287159783L, -319920900L, 990095821L, 
458973738L, -296501853L, -682417528L, -925135127L, -1929624170L, 
-81635553L, 806049492L, 1666272197L, -189289022L, -123011493L, 
-835498528L, 132758625L, -249706834L, 1587343191L, -1423305812L, 
1197309117L, 1643084890L, 309405203L, -1449298888L, 1177872601L, 
-787842362L, 1751539343L, 727055236L, 220470453L, 2014653938L, 
1782387915L, 1103295888L, -2061044655L, -1897217570L, 531858631L
)
